# Cookie Cats Mobile Game: A/B Testing Analysis

# 项目背景 (Background)

Cookie Cats 是一款经典的“三连棋”式（Match-3）手机益智游戏。随着玩家通过关卡，游戏会设置“障碍（Gates）”，强制玩家等待一段时间或进行内购才能继续游戏。这不仅是为了盈利，也是为了给玩家提供休息时间，以防止产生厌倦感。

本次 A/B 测试的核心问题：将游戏中的第一个“障碍”从 第30关 (Gate 30) 移到 第40关 (Gate 40)，会对玩家的游戏时长和留存率产生什么影响？

本项目通过分析 A/B 测试数据，运用统计学方法评估这一变动是否带来了显著的业务指标提升。

**实验前置设计与准备**

1.核心指标体系构建 (Metric Definition)为了量化评估“将障碍从 Gate 30 移至 Gate 40”的业务影响，我们在实验开启前定义了以下指标体系：

核心指标 (OEC - Overall Evaluation Criteria)

1日留存 (Retention_1) & 7日留存 (Retention_7) & 游戏回合数 (Sum_GameRounds)

2.最小样本量估算为了避免“因样本不足导致无法检测出真实差异” 

基本原理：基于假设检验参数反推 $N$：显著性水平 ($\alpha$): 0.05 (控制误报率)。

统计功效 Power ($1-\beta$): 0.80 (保证有 80% 的概率能检测出差异)。

最小可检测效应 (MDE): 设定为相对提升 2%~5%（基于业务预期的 ROI 阈值）。

操作方式：利用统计学公式计算得出，要检测出上述MDE，单组样本量需达到约 1.6万人。数据现状：本数据集包含 90,189 名用户（每组约 4.5 万），远超理论最小样本量，这保证了实验具备极高的统计效力。

3.流量分发与随机化 (Traffic Splitting & Randomization)

假定数据获得是根据以下分流机制：

分流单元 (Unit of Diversion)：User_ID —— 原理：确保同一用户在实验全周期内始终看到相同的关卡版本（避免用户今天看到 Gate 30，明天看到 Gate 40 造成体验割裂）。

分流算法 (Hashing Algorithm)：Hash(User_ID + Salt) % 100 —— 原理：相比简单的 Random()，哈希算法具备确定性 (Deterministic) 和正交性 (Orthogonality)，能有效打散用户特征（如设备、地区、注册时间），消除选择性偏差 (Selection Bias)。

4.实验周期设定 (Experiment Duration)

设定原则：必须覆盖完整的周周期 (Weekly Cycle)。

操作方式：由于休闲手游用户存在明显的“周末效应”（周末活跃度显著高于工作日），为了平滑时间维度的波动，实验数据采集必须至少持续 7 天（或 14 天）。

假定本数据集涵盖了整数周窗口期，有效规避了时间偏差。

# 数据集说明 (Dataset)

数据来源于 cookie_cats.txt，包含 90,189 名玩家的数据。

      字  段            |                          描述
      userid            |                   玩家的唯一标识符
      version           |     实验分组：gate_30 (对照组) 或 gate_40 (实验组)
      sum_gamerounds    |         玩家在安装后前14天内进行的游戏回合总数
      retention_1       |   次日留存：玩家在安装后第1天是否再次登录 (True/False)
      retention_7       |   7日留存：玩家在安装后第7天是否再次登录 (True/False)


# 分析流程与方法 (Methodology)

采用 Python 进行完整的数据清洗与统计推断，主要步骤如下：

1. 数据预处理完整性检查：确认无缺失值，无重复用户 ID。
   
   异常值处理：发现并剔除了一名 sum_gamerounds 高达 49,854 的极端异常用户，避免拉偏均值。
   
2. 实验设计与样本量计算 (Sample Size Calculation)
 
   在进行检验前，基于统计功效（Power = 0.8）和显著性水平（Alpha = 0.05）计算理论所需样本量，确保实验结果的可靠性。
   
   均值类指标：设定 MDE (最小可检测效应) 为 5 次游戏回合。
   
   比率类指标：设定 MDE 为相对提升 2% (次日留存) 和 5% (7日留存)。**结论：**实际样本量（每组约 4.5w 人）足以支持上述效应的检测。
   
3. 假设检验 (Hypothesis Testing)针对三个核心指标进行了单尾检验（H1: 实验组指标 > 对照组指标）：
 
  1）游戏回合数 (Mean Metric)检验方法：Levene's Test (方差齐性检验) + T-test / Z-test。**结果：**P-value $\approx$ 1.0，未能拒绝原假设。
   
  2）1天 & 7天留存率 (Proportion Metric)检验方法：Proportions Z-test。**结果：**未能拒绝原假设，且实验组的留存率在数值上略低于对照组。
  
# 实验结论 (Results & Conclusion)经过严格的统计检验，得出以下结论：

游戏时长：将障碍移至 40 关并未显著增加玩家的平均游戏回合数。

玩家留存：无论是次日留存还是 7 日留存，gate_40 版本均未表现出优于 gate_30 的特征。

实际上，数据暗示推迟障碍出现（让玩家玩得更久才遇到挫折）并没有提高玩家的粘性。

# 业务建议

### 基于当前数据，不建议将障碍从 30 关移至 40 关。建议维持当前设置，或尝试其他关卡位置（如更早的关卡）进行新的测试。

# 技术栈 (Tech Stack)

Python 3.x(Pandas & Numpy: 数据处理与清洗Statsmodels & Scipy: 样本量计算、正态分布模拟、Z检验、T检验 etc.)
